<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.7.2" />
<title>test_40_assess30 API documentation</title>
<meta name="description" content="Test scenario for assessments â€¦" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>test_40_assess30</code></h1>
</header>
<section id="section-intro">
<p>Test scenario for assessments.</p>
<h2 id="domain">Domain</h2>
<ul>
<li>Users as in <a title="conftest" href="conftest.html"><code>conftest</code></a>, under <em>players</em></li>
<li>Clean slate, see <a title="starters" href="starters.html"><code>starters</code></a>.</li>
<li>The user table</li>
<li>The country table</li>
<li>One contribution record</li>
<li>One assessment record</li>
</ul>
<h2 id="acts">Acts</h2>
<p>Filling out an assessment.</p>
<dl>
<dt><a title="test_40_assess30.test_criteriaEntries" href="#test_40_assess30.test_criteriaEntries"><code>test_criteriaEntries()</code></a></dt>
<dd>All users try to see the criteria entries. Only <strong>owner</strong> and <strong>editor</strong> succeed.</dd>
<dt><a title="test_40_assess30.test_fillEvidenceAll" href="#test_40_assess30.test_fillEvidenceAll"><code>test_fillEvidenceAll()</code></a></dt>
<dd>All users try to fill out the evidence for the first entry.
Only some users succeed.</dd>
<dt><a title="test_40_assess30.test_fillEvidenceOwner" href="#test_40_assess30.test_fillEvidenceOwner"><code>test_fillEvidenceOwner()</code></a></dt>
<dd><strong>owner</strong> fills out the evidence for all entries.</dd>
<dt><a title="test_40_assess30.test_fillScore" href="#test_40_assess30.test_fillScore"><code>test_fillScore()</code></a></dt>
<dd><strong>owner</strong> tries to fill out a score.</dd>
<dt><a title="test_40_assess30.test_fillScoreWrong" href="#test_40_assess30.test_fillScoreWrong"><code>test_fillScoreWrong()</code></a></dt>
<dd>
<p><strong>owner</strong> tries to fill out a score that belongs to another criterion.</p>
<div class="admonition note">
<p class="admonition-title">Not tested before</p>
<p>This is the first time that we use a value table where the possible
values are constrained by another constraint:</p>
<p>Only those scores are eligible that have the same <code>criteria</code> master as
the <code>criteriaEntry</code> record.</p>
</div>
</dd>
<dt><a title="test_40_assess30.test_submitAssessment" href="#test_40_assess30.test_submitAssessment"><code>test_submitAssessment()</code></a></dt>
<dd>**owner tries to submit the assessment, but fails, because not all fields
are filled out.</dd>
<dt><a title="test_40_assess30.test_complete" href="#test_40_assess30.test_complete"><code>test_complete()</code></a></dt>
<dd><strong>owner</strong> fills out the criteria.
If not all fields are filled in, the status remains <code>incomplete</code>,
and at the end the status is <code>complete</code>.</dd>
<dt><a title="test_40_assess30.test_assignReviewers" href="#test_40_assess30.test_assignReviewers"><code>test_assignReviewers()</code></a></dt>
<dd>All users try to assign reviewers to this assessment, but they all fail.
Most users fail because they do not have the right permission level.
The power users fail because of a workflow condition:
the assessment is complete, not yet submitted.</dd>
<dt><a title="test_40_assess30.test_withdrawAssessment" href="#test_40_assess30.test_withdrawAssessment"><code>test_withdrawAssessment()</code></a></dt>
<dd><strong>owner</strong> tries to withdraw the assessment, unsuccessfully, because it has not
been submitted.</dd>
<dt><a title="test_40_assess30.test_inspectTitleAll2" href="#test_40_assess30.test_inspectTitleAll2"><code>test_inspectTitleAll2()</code></a></dt>
<dd>We check of the assessment is still private to <strong>owner</strong>.</dd>
<dt><a title="test_40_assess30.test_resubmitAssessment" href="#test_40_assess30.test_resubmitAssessment"><code>test_resubmitAssessment()</code></a></dt>
<dd><strong>owner</strong> tries to re-submit the assessment, unsuccessfully, because it has not
been submitted.</dd>
<dt><a title="test_40_assess30.test_submitAssessmentRevised" href="#test_40_assess30.test_submitAssessmentRevised"><code>test_submitAssessmentRevised()</code></a></dt>
<dd><strong>owner</strong> tries to submit the assessment as revision, unsuccessfully.</dd>
<dt><a title="test_40_assess30.test_submitAssessment2" href="#test_40_assess30.test_submitAssessment2"><code>test_submitAssessment2()</code></a></dt>
<dd><strong>owner</strong> tries to submit the assessment, successfully.</dd>
<dt><a title="test_40_assess30.test_assignReviewers2" href="#test_40_assess30.test_assignReviewers2"><code>test_assignReviewers2()</code></a></dt>
<dd>All users try to assign reviewers to this assessment.
The power users succeed because of a workflow condition:
the assessment is submitted.</dd>
<dt><a title="test_40_assess30.test_inspectTitleAll3" href="#test_40_assess30.test_inspectTitleAll3"><code>test_inspectTitleAll3()</code></a></dt>
<dd>We check of the assessment is still private to <strong>owner</strong>.</dd>
</dl>
<ul>
<li><strong>owner</strong> tries to submit the assessment, unsuccessfully, because it has already
been submitted.</li>
<li><strong>owner</strong> tries to withdraw the assessment, successfully.</li>
<li><strong>owner</strong> tries to submit the assessment as revision, unsuccessfully.</li>
<li><strong>owner</strong> tries to resubmit the assessment successfully.</li>
<li>We check of the assessment is still private to <strong>owner</strong>.</li>
</ul>
<dl>
<dt><a title="test_40_assess30.test_withdrawAssessment2" href="#test_40_assess30.test_withdrawAssessment2"><code>test_withdrawAssessment2()</code></a></dt>
<dd><strong>owner</strong> tries to withdraw the assessment, successfully been submitted.</dd>
<dt><a title="test_40_assess30.test_submitAssessmentRevised2" href="#test_40_assess30.test_submitAssessmentRevised2"><code>test_submitAssessmentRevised2()</code></a></dt>
<dd>**owwner cannot submit this assessment as a revision.</dd>
<dt><a title="test_40_assess30.test_resubmitAssessment2" href="#test_40_assess30.test_resubmitAssessment2"><code>test_resubmitAssessment2()</code></a></dt>
<dd><strong>owner</strong> re-submits this assessment.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;Test scenario for assessments.

## Domain

*   Users as in `conftest`, under *players*
*   Clean slate, see `starters`.
*   The user table
*   The country table
*   One contribution record
*   One assessment record

## Acts

Filling out an assessment.

`test_criteriaEntries`
:   All users try to see the criteria entries. Only **owner** and **editor** succeed.

`test_fillEvidenceAll`
:   All users try to fill out the evidence for the first entry.
    Only some users succeed.

`test_fillEvidenceOwner`
:   **owner** fills out the evidence for all entries.

`test_fillScore`
:   **owner** tries to fill out a score.

`test_fillScoreWrong`
:   **owner** tries to fill out a score that belongs to another criterion.

    !!! note &#34;Not tested before&#34;
        This is the first time that we use a value table where the possible
        values are constrained by another constraint:

        Only those scores are eligible that have the same `criteria` master as
        the `criteriaEntry` record.

`test_submitAssessment`
:   **owner tries to submit the assessment, but fails, because not all fields
    are filled out.

`test_complete`
:   **owner** fills out the criteria.
    If not all fields are filled in, the status remains `incomplete`,
    and at the end the status is `complete`.

`test_assignReviewers`
:   All users try to assign reviewers to this assessment, but they all fail.
    Most users fail because they do not have the right permission level.
    The power users fail because of a workflow condition:
    the assessment is complete, not yet submitted.

`test_withdrawAssessment`
:   **owner** tries to withdraw the assessment, unsuccessfully, because it has not
    been submitted.

`test_inspectTitleAll2`
:   We check of the assessment is still private to **owner**.

`test_resubmitAssessment`
:   **owner** tries to re-submit the assessment, unsuccessfully, because it has not
    been submitted.

`test_submitAssessmentRevised`
:   **owner** tries to submit the assessment as revision, unsuccessfully.

`test_submitAssessment2`
:   **owner** tries to submit the assessment, successfully.

`test_assignReviewers2`
:   All users try to assign reviewers to this assessment.
    The power users succeed because of a workflow condition:
    the assessment is submitted.

`test_inspectTitleAll3`
:   We check of the assessment is still private to **owner**.

*   **owner** tries to submit the assessment, unsuccessfully, because it has already
    been submitted.
*   **owner** tries to withdraw the assessment, successfully.
*   **owner** tries to submit the assessment as revision, unsuccessfully.
*   **owner** tries to resubmit the assessment successfully.
*   We check of the assessment is still private to **owner**.

`test_withdrawAssessment2`
:   **owner** tries to withdraw the assessment, successfully been submitted.

`test_submitAssessmentRevised2`
:   **owwner cannot submit this assessment as a revision.

`test_resubmitAssessment2`
:   **owner** re-submits this assessment.
&#34;&#34;&#34;

import pytest

import magic  # noqa
from control.utils import pick as G
from conftest import USERS, RIGHTFUL_USERS
from example import (
    ASSESS,
    CRITERIA_ENTRY,
)
from helpers import (
    findDetails,
    findItem,
    forall,
    getRelatedValues,
)
from starters import (
    start,
)
from subtest import (
    assertModifyField,
    assertStage,
    assertStatus,
    inspectTitleAll,
    assignReviewers,
)

recordInfo = {}
valueTables = {}

cIds = []
ids = {}


def test_start(clientOffice, clientOwner):
    start(
        clientOffice=clientOffice,
        clientOwner=clientOwner,
        users=True,
        assessment=True,
        countries=True,
        valueTables=valueTables,
        recordInfo=recordInfo,
        ids=ids,
    )


def test_criteriaEntries(clients):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    ellips = &#34;&lt;div&gt;...&lt;/div&gt;&#34;
    dtable = &#34;criteriaEntry&#34;

    def assertIt(cl, exp):
        (text, fields, msgs, dummy) = findItem(cl, ASSESS, aId)
        criteriaEntries = findDetails(text, dtable)
        nEntries = len(criteriaEntries)
        if exp:
            assert nEntries == 4
            for (cId, material) in criteriaEntries:
                assert ellips in material
        else:
            assert nEntries == 0

    expect = {user: False for user in USERS}
    expect.update({user: True for user in RIGHTFUL_USERS})
    forall(clients, expect, assertIt)


def test_fillEvidenceAll(clients):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    dtable = &#34;criteriaEntry&#34;
    field = &#34;evidence&#34;
    clientOwner = clients[&#34;owner&#34;]
    (text, fields, msgs, dummy) = assertStage(clientOwner, ASSESS, aId, &#34;incomplete&#34;)
    criteriaEntries = findDetails(text, dtable)
    cId = criteriaEntries[0][0]

    def assertIt(cl, exp):
        theEvidence = [f&#34;evidence for  1&#34;, &#34;see the internet&#34;]
        theEvidenceRep = &#34;,&#34;.join(theEvidence)
        assertModifyField(
            cl, CRITERIA_ENTRY, cId, field, (theEvidence, theEvidenceRep), exp
        )

    expect = {user: False for user in USERS}
    expect.update({user: True for user in RIGHTFUL_USERS})
    forall(clients, expect, assertIt)


def test_fillEvidenceOwner(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    ellips = &#34;&lt;div&gt;...&lt;/div&gt;&#34;

    (text, fields, msgs, dummy) = assertStage(clientOwner, ASSESS, aId, &#34;incomplete&#34;)

    dtable = &#34;criteriaEntry&#34;
    criteriaEntries = findDetails(text, dtable)
    assert len(criteriaEntries) == 4

    for (i, (cId, material)) in enumerate(criteriaEntries):
        assert ellips in material
        theEvidence = [f&#34;evidence for {i + 1}&#34;, &#34;see the internet&#34;]
        theEvidenceRep = &#34;,&#34;.join(theEvidence)
        field = &#34;evidence&#34;
        assertModifyField(
            clientOwner, CRITERIA_ENTRY, cId, field, (theEvidence, theEvidenceRep), True
        )
        cIds.append(cId)


def test_fillScore(clientOwner):
    cId = cIds[0]
    field = &#34;score&#34;
    scores = getRelatedValues(clientOwner, CRITERIA_ENTRY, cId, field)
    (scoreValue, scoreId) = sorted(scores.items())[0]
    assertModifyField(
        clientOwner, CRITERIA_ENTRY, cId, field, (scoreId, scoreValue), True
    )


def test_fillScoreWrong(clientOwner):
    cId = cIds[0]
    cIdx = cIds[1]
    field = &#34;score&#34;
    (text, fields, msgs, eid) = findItem(clientOwner, CRITERIA_ENTRY, cId)
    scores = getRelatedValues(clientOwner, CRITERIA_ENTRY, cIdx, field)
    (scoreValue, scoreId) = sorted(scores.items())[0]
    assertModifyField(
        clientOwner, CRITERIA_ENTRY, cId, field, (scoreId, scoreValue), False
    )


def test_submitAssessment(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    url = f&#34;/api/task/submitAssessment/{aId}&#34;
    assertStatus(clientOwner, url, False)


def test_complete(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    field = &#34;score&#34;
    nCId = len(cIds)

    for (i, cId) in enumerate(cIds):
        scores = getRelatedValues(clientOwner, CRITERIA_ENTRY, cId, field)
        (scoreValue, scoreId) = sorted(scores.items())[1]
        if i == nCId - 1:
            assertStage(clientOwner, ASSESS, aId, &#34;incomplete&#34;)

        assertModifyField(
            clientOwner, CRITERIA_ENTRY, cId, field, (scoreId, scoreValue), True
        )
    assertStage(clientOwner, ASSESS, aId, &#34;complete&#34;)


@pytest.mark.parametrize(
    (&#34;field&#34;, &#34;valueRep&#34;),
    (
        (&#34;reviewerE&#34;, &#34;expert&#34;),
        (&#34;reviewerF&#34;, &#34;final&#34;),
    ),
)
def test_assignReviewers(clients, field, valueRep):
    users = G(valueTables, &#34;user&#34;)
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    expect = {user: False for user in USERS}
    assignReviewers(clients, recordInfo, users, aId, field, valueRep, expect)


def test_withdrawAssessment(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    url = f&#34;/api/task/withdrawAssessment/{aId}&#34;
    assertStatus(clientOwner, url, False)


def test_inspectTitleAll2(clients):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    aTitle = G(G(recordInfo, ASSESS), &#34;title&#34;)
    expect = {user: None for user in USERS}
    expect.update({user: aTitle for user in RIGHTFUL_USERS})
    inspectTitleAll(clients, aId, expect)


def test_resubmitAssessment(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    url = f&#34;/api/task/resubmitAssessment/{aId}&#34;
    assertStatus(clientOwner, url, False)


def test_submitAssessmentRevised(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    url = f&#34;/api/task/submitRevised/{aId}&#34;
    assertStatus(clientOwner, url, False)


def test_submitAssessment2(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    url = f&#34;/api/task/submitAssessment/{aId}&#34;
    assertStatus(clientOwner, url, True)


@pytest.mark.parametrize(
    (&#34;field&#34;, &#34;valueRep&#34;),
    (
        (&#34;reviewerE&#34;, &#34;expert&#34;),
        (&#34;reviewerF&#34;, &#34;final&#34;),
    ),
)
def test_assignReviewers2(clients, field, valueRep):
    users = G(valueTables, &#34;user&#34;)
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    expect = {user: False for user in USERS}
    expect[&#34;office&#34;] = True
    assignReviewers(clients, recordInfo, users, aId, field, valueRep, expect)


def test_inspectTitleAll3(clients):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    aTitle = G(G(recordInfo, ASSESS), &#34;title&#34;)
    expect = {user: None for user in USERS}
    expect.update({user: aTitle for user in RIGHTFUL_USERS})
    expect.update(dict(mycoord=aTitle))
    inspectTitleAll(clients, aId, expect)


def test_withdrawAssessment2(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    url = f&#34;/api/task/withdrawAssessment/{aId}&#34;
    assertStatus(clientOwner, url, True)


def test_submitAssessmentRevised2(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    url = f&#34;/api/task/submitRevised/{aId}&#34;
    assertStatus(clientOwner, url, False)


def test_resubmitAssessment2(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    url = f&#34;/api/task/resubmitAssessment/{aId}&#34;
    assertStatus(clientOwner, url, True)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="test_40_assess30.test_assignReviewers"><code class="name flex">
<span>def <span class="ident">test_assignReviewers</span></span>(<span>clients, field, valueRep)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@pytest.mark.parametrize(
    (&#34;field&#34;, &#34;valueRep&#34;),
    (
        (&#34;reviewerE&#34;, &#34;expert&#34;),
        (&#34;reviewerF&#34;, &#34;final&#34;),
    ),
)
def test_assignReviewers(clients, field, valueRep):
    users = G(valueTables, &#34;user&#34;)
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    expect = {user: False for user in USERS}
    assignReviewers(clients, recordInfo, users, aId, field, valueRep, expect)</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_assignReviewers2"><code class="name flex">
<span>def <span class="ident">test_assignReviewers2</span></span>(<span>clients, field, valueRep)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@pytest.mark.parametrize(
    (&#34;field&#34;, &#34;valueRep&#34;),
    (
        (&#34;reviewerE&#34;, &#34;expert&#34;),
        (&#34;reviewerF&#34;, &#34;final&#34;),
    ),
)
def test_assignReviewers2(clients, field, valueRep):
    users = G(valueTables, &#34;user&#34;)
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    expect = {user: False for user in USERS}
    expect[&#34;office&#34;] = True
    assignReviewers(clients, recordInfo, users, aId, field, valueRep, expect)</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_complete"><code class="name flex">
<span>def <span class="ident">test_complete</span></span>(<span>clientOwner)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_complete(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    field = &#34;score&#34;
    nCId = len(cIds)

    for (i, cId) in enumerate(cIds):
        scores = getRelatedValues(clientOwner, CRITERIA_ENTRY, cId, field)
        (scoreValue, scoreId) = sorted(scores.items())[1]
        if i == nCId - 1:
            assertStage(clientOwner, ASSESS, aId, &#34;incomplete&#34;)

        assertModifyField(
            clientOwner, CRITERIA_ENTRY, cId, field, (scoreId, scoreValue), True
        )
    assertStage(clientOwner, ASSESS, aId, &#34;complete&#34;)</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_criteriaEntries"><code class="name flex">
<span>def <span class="ident">test_criteriaEntries</span></span>(<span>clients)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_criteriaEntries(clients):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    ellips = &#34;&lt;div&gt;...&lt;/div&gt;&#34;
    dtable = &#34;criteriaEntry&#34;

    def assertIt(cl, exp):
        (text, fields, msgs, dummy) = findItem(cl, ASSESS, aId)
        criteriaEntries = findDetails(text, dtable)
        nEntries = len(criteriaEntries)
        if exp:
            assert nEntries == 4
            for (cId, material) in criteriaEntries:
                assert ellips in material
        else:
            assert nEntries == 0

    expect = {user: False for user in USERS}
    expect.update({user: True for user in RIGHTFUL_USERS})
    forall(clients, expect, assertIt)</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_fillEvidenceAll"><code class="name flex">
<span>def <span class="ident">test_fillEvidenceAll</span></span>(<span>clients)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_fillEvidenceAll(clients):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    dtable = &#34;criteriaEntry&#34;
    field = &#34;evidence&#34;
    clientOwner = clients[&#34;owner&#34;]
    (text, fields, msgs, dummy) = assertStage(clientOwner, ASSESS, aId, &#34;incomplete&#34;)
    criteriaEntries = findDetails(text, dtable)
    cId = criteriaEntries[0][0]

    def assertIt(cl, exp):
        theEvidence = [f&#34;evidence for  1&#34;, &#34;see the internet&#34;]
        theEvidenceRep = &#34;,&#34;.join(theEvidence)
        assertModifyField(
            cl, CRITERIA_ENTRY, cId, field, (theEvidence, theEvidenceRep), exp
        )

    expect = {user: False for user in USERS}
    expect.update({user: True for user in RIGHTFUL_USERS})
    forall(clients, expect, assertIt)</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_fillEvidenceOwner"><code class="name flex">
<span>def <span class="ident">test_fillEvidenceOwner</span></span>(<span>clientOwner)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_fillEvidenceOwner(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    ellips = &#34;&lt;div&gt;...&lt;/div&gt;&#34;

    (text, fields, msgs, dummy) = assertStage(clientOwner, ASSESS, aId, &#34;incomplete&#34;)

    dtable = &#34;criteriaEntry&#34;
    criteriaEntries = findDetails(text, dtable)
    assert len(criteriaEntries) == 4

    for (i, (cId, material)) in enumerate(criteriaEntries):
        assert ellips in material
        theEvidence = [f&#34;evidence for {i + 1}&#34;, &#34;see the internet&#34;]
        theEvidenceRep = &#34;,&#34;.join(theEvidence)
        field = &#34;evidence&#34;
        assertModifyField(
            clientOwner, CRITERIA_ENTRY, cId, field, (theEvidence, theEvidenceRep), True
        )
        cIds.append(cId)</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_fillScore"><code class="name flex">
<span>def <span class="ident">test_fillScore</span></span>(<span>clientOwner)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_fillScore(clientOwner):
    cId = cIds[0]
    field = &#34;score&#34;
    scores = getRelatedValues(clientOwner, CRITERIA_ENTRY, cId, field)
    (scoreValue, scoreId) = sorted(scores.items())[0]
    assertModifyField(
        clientOwner, CRITERIA_ENTRY, cId, field, (scoreId, scoreValue), True
    )</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_fillScoreWrong"><code class="name flex">
<span>def <span class="ident">test_fillScoreWrong</span></span>(<span>clientOwner)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_fillScoreWrong(clientOwner):
    cId = cIds[0]
    cIdx = cIds[1]
    field = &#34;score&#34;
    (text, fields, msgs, eid) = findItem(clientOwner, CRITERIA_ENTRY, cId)
    scores = getRelatedValues(clientOwner, CRITERIA_ENTRY, cIdx, field)
    (scoreValue, scoreId) = sorted(scores.items())[0]
    assertModifyField(
        clientOwner, CRITERIA_ENTRY, cId, field, (scoreId, scoreValue), False
    )</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_inspectTitleAll2"><code class="name flex">
<span>def <span class="ident">test_inspectTitleAll2</span></span>(<span>clients)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_inspectTitleAll2(clients):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    aTitle = G(G(recordInfo, ASSESS), &#34;title&#34;)
    expect = {user: None for user in USERS}
    expect.update({user: aTitle for user in RIGHTFUL_USERS})
    inspectTitleAll(clients, aId, expect)</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_inspectTitleAll3"><code class="name flex">
<span>def <span class="ident">test_inspectTitleAll3</span></span>(<span>clients)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_inspectTitleAll3(clients):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    aTitle = G(G(recordInfo, ASSESS), &#34;title&#34;)
    expect = {user: None for user in USERS}
    expect.update({user: aTitle for user in RIGHTFUL_USERS})
    expect.update(dict(mycoord=aTitle))
    inspectTitleAll(clients, aId, expect)</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_resubmitAssessment"><code class="name flex">
<span>def <span class="ident">test_resubmitAssessment</span></span>(<span>clientOwner)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_resubmitAssessment(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    url = f&#34;/api/task/resubmitAssessment/{aId}&#34;
    assertStatus(clientOwner, url, False)</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_resubmitAssessment2"><code class="name flex">
<span>def <span class="ident">test_resubmitAssessment2</span></span>(<span>clientOwner)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_resubmitAssessment2(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    url = f&#34;/api/task/resubmitAssessment/{aId}&#34;
    assertStatus(clientOwner, url, True)</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_start"><code class="name flex">
<span>def <span class="ident">test_start</span></span>(<span>clientOffice, clientOwner)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_start(clientOffice, clientOwner):
    start(
        clientOffice=clientOffice,
        clientOwner=clientOwner,
        users=True,
        assessment=True,
        countries=True,
        valueTables=valueTables,
        recordInfo=recordInfo,
        ids=ids,
    )</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_submitAssessment"><code class="name flex">
<span>def <span class="ident">test_submitAssessment</span></span>(<span>clientOwner)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_submitAssessment(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    url = f&#34;/api/task/submitAssessment/{aId}&#34;
    assertStatus(clientOwner, url, False)</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_submitAssessment2"><code class="name flex">
<span>def <span class="ident">test_submitAssessment2</span></span>(<span>clientOwner)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_submitAssessment2(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    url = f&#34;/api/task/submitAssessment/{aId}&#34;
    assertStatus(clientOwner, url, True)</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_submitAssessmentRevised"><code class="name flex">
<span>def <span class="ident">test_submitAssessmentRevised</span></span>(<span>clientOwner)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_submitAssessmentRevised(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    url = f&#34;/api/task/submitRevised/{aId}&#34;
    assertStatus(clientOwner, url, False)</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_submitAssessmentRevised2"><code class="name flex">
<span>def <span class="ident">test_submitAssessmentRevised2</span></span>(<span>clientOwner)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_submitAssessmentRevised2(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    url = f&#34;/api/task/submitRevised/{aId}&#34;
    assertStatus(clientOwner, url, False)</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_withdrawAssessment"><code class="name flex">
<span>def <span class="ident">test_withdrawAssessment</span></span>(<span>clientOwner)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_withdrawAssessment(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    url = f&#34;/api/task/withdrawAssessment/{aId}&#34;
    assertStatus(clientOwner, url, False)</code></pre>
</details>
</dd>
<dt id="test_40_assess30.test_withdrawAssessment2"><code class="name flex">
<span>def <span class="ident">test_withdrawAssessment2</span></span>(<span>clientOwner)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_withdrawAssessment2(clientOwner):
    aId = G(G(recordInfo, ASSESS), &#34;eid&#34;)
    url = f&#34;/api/task/withdrawAssessment/{aId}&#34;
    assertStatus(clientOwner, url, True)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#domain">Domain</a></li>
<li><a href="#acts">Acts</a></li>
</ul>
</div>
<ul id="index">
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="test_40_assess30.test_assignReviewers" href="#test_40_assess30.test_assignReviewers">test_assignReviewers</a></code></li>
<li><code><a title="test_40_assess30.test_assignReviewers2" href="#test_40_assess30.test_assignReviewers2">test_assignReviewers2</a></code></li>
<li><code><a title="test_40_assess30.test_complete" href="#test_40_assess30.test_complete">test_complete</a></code></li>
<li><code><a title="test_40_assess30.test_criteriaEntries" href="#test_40_assess30.test_criteriaEntries">test_criteriaEntries</a></code></li>
<li><code><a title="test_40_assess30.test_fillEvidenceAll" href="#test_40_assess30.test_fillEvidenceAll">test_fillEvidenceAll</a></code></li>
<li><code><a title="test_40_assess30.test_fillEvidenceOwner" href="#test_40_assess30.test_fillEvidenceOwner">test_fillEvidenceOwner</a></code></li>
<li><code><a title="test_40_assess30.test_fillScore" href="#test_40_assess30.test_fillScore">test_fillScore</a></code></li>
<li><code><a title="test_40_assess30.test_fillScoreWrong" href="#test_40_assess30.test_fillScoreWrong">test_fillScoreWrong</a></code></li>
<li><code><a title="test_40_assess30.test_inspectTitleAll2" href="#test_40_assess30.test_inspectTitleAll2">test_inspectTitleAll2</a></code></li>
<li><code><a title="test_40_assess30.test_inspectTitleAll3" href="#test_40_assess30.test_inspectTitleAll3">test_inspectTitleAll3</a></code></li>
<li><code><a title="test_40_assess30.test_resubmitAssessment" href="#test_40_assess30.test_resubmitAssessment">test_resubmitAssessment</a></code></li>
<li><code><a title="test_40_assess30.test_resubmitAssessment2" href="#test_40_assess30.test_resubmitAssessment2">test_resubmitAssessment2</a></code></li>
<li><code><a title="test_40_assess30.test_start" href="#test_40_assess30.test_start">test_start</a></code></li>
<li><code><a title="test_40_assess30.test_submitAssessment" href="#test_40_assess30.test_submitAssessment">test_submitAssessment</a></code></li>
<li><code><a title="test_40_assess30.test_submitAssessment2" href="#test_40_assess30.test_submitAssessment2">test_submitAssessment2</a></code></li>
<li><code><a title="test_40_assess30.test_submitAssessmentRevised" href="#test_40_assess30.test_submitAssessmentRevised">test_submitAssessmentRevised</a></code></li>
<li><code><a title="test_40_assess30.test_submitAssessmentRevised2" href="#test_40_assess30.test_submitAssessmentRevised2">test_submitAssessmentRevised2</a></code></li>
<li><code><a title="test_40_assess30.test_withdrawAssessment" href="#test_40_assess30.test_withdrawAssessment">test_withdrawAssessment</a></code></li>
<li><code><a title="test_40_assess30.test_withdrawAssessment2" href="#test_40_assess30.test_withdrawAssessment2">test_withdrawAssessment2</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.7.2</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>